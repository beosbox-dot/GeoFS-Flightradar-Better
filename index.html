<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AeroPulse - Sharp Glassy Edition</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<style>
/* üåå Reset */
* {margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',sans-serif;}
body, html {width:100%;height:100%;background:#0d0f14;color:#fff;overflow:hidden;}

/* üåü Sidebar sharp + glass */
#sidebar {
    width:80px; height:100vh;
    background: rgba(20,22,28,0.55); /* tint nh·∫π */
    backdrop-filter: blur(18px);
    display:flex;flex-direction:column;align-items:center;padding:20px 0;
    position:fixed;left:0;top:0;z-index:1000;
    border-right:1px solid rgba(255,255,255,0.08);
    transition: all 0.3s ease;
}

#sidebar .logo {
    font-size:24px;font-weight:700;color:#2ca1ff;margin-bottom:30px;text-align:center;
    letter-spacing:2px;
}

/* Buttons sharp + symbol */
#sidebar button {
    width:50px;height:50px;margin:12px 0;
    background: rgba(255,255,255,0.05);
    border:none;
    border-radius:0; /* g√≥c c·∫°nh */
    font-size:28px;
    color:#bbb;
    cursor:pointer;
    display:flex;justify-content:center;align-items:center;
    transition: all 0.3s ease, transform 0.3s ease, background 0.3s ease, color 0.3s ease;
    position:relative;
    overflow:hidden;
}

/* Hover / Active effect */
#sidebar button.active, #sidebar button:hover {
    background: rgba(44,161,255,0.15);
    color:#2ca1ff;
    transform: scale(1.15);
}

/* ‚ú® Custom symbol for sidebar except flight */
.symbol-box {
    width:18px; height:18px;
    stroke:#bbb; stroke-width:2; fill:none;
    transition: stroke 0.3s ease, transform 0.3s ease;
}
#sidebar button.active .symbol-box,
#sidebar button:hover .symbol-box {
    stroke:#2ca1ff;
    transform: scale(1.2);
}

/* üíß Pop-up glassy animation */
#formContainer {
    display:none;
    position:absolute;
    top:0;left:80px;
    width:calc(100% - 80px);
    height:100vh;
    background: rgba(18,20,28,0.55); /* tint nh·∫π */
    backdrop-filter: blur(20px);
    padding:40px;
    overflow-y:auto;
    z-index:1000;
    transition: all 0.4s ease;
}

#formContainer.show {
    animation: popFluid 0.35s cubic-bezier(0.25, 1, 0.5, 1) forwards;
}

@keyframes popFluid {
    0% {opacity:0; transform:scale(0.85);}
    60% {opacity:1; transform:scale(1.03);}
    100% {transform:scale(1);}
}

/* ‚úàÔ∏é Flight Form */
#flightForm {
    max-width:480px; margin:0 auto;
    background: rgba(30,30,40,0.6);
    padding:30px 40px;
    border-radius:0; /* g√≥c c·∫°nh */
    box-shadow: 0 12px 30px rgba(0,0,0,0.5);
    backdrop-filter: blur(20px);
    transition: all 0.3s ease;
}

#flightForm h2 {
    text-align:center;color:#2ca1ff;font-weight:600;font-size:20px;margin-bottom:20px;
}

#flightForm label {
    display:block;color:#ccc;margin-top:12px;font-size:14px;
}

#flightForm input {
    width:100%;padding:10px 12px;border-radius:0;border:1px solid rgba(255,255,255,0.2);
    background: rgba(20,22,28,0.45);color:#fff;margin-top:6px;font-size:14px;
    transition:0.25s ease;
}

#flightForm input:focus {border-color:#2ca1ff;box-shadow:0 0 10px rgba(44,161,255,0.3);outline:none;}

#flightForm button {
    width:100%;padding:12px;margin-top:20px;border:none;border-radius:0;
    background:#2ca1ff;color:#fff;font-size:15px;font-weight:600;cursor:pointer;
    transition:0.25s ease, transform 0.2s;
}

#flightForm button:hover {background:#1b8de0;transform:translateY(-2px);}

/* üó∫Ô∏è Map */
#map {position:absolute;top:0;left:80px;right:0;bottom:0;z-index:0;}

/* Scrollbar glassy */
#formContainer::-webkit-scrollbar {width:10px;}
#formContainer::-webkit-scrollbar-thumb {background:rgba(100,100,100,0.4);border-radius:0;}
#formContainer::-webkit-scrollbar-thumb:hover {background:rgba(180,180,180,0.5);}
</style>
</head>
<body>

<!-- Sidebar -->
<div id="sidebar">
    <div class="logo">Aero</div>

    <!-- Home symbol: custom SVG -->
    <button id="homeBtn" title="Home">
        <svg class="symbol-box" viewBox="0 0 24 24">
            <polyline points="3,12 12,3 21,12" />
            <rect x="6" y="12" width="12" height="9" />
        </svg>
    </button>

    <!-- New Flight: ‚úàÔ∏é -->
    <button id="newFlightBtn" title="New Flight">‚úàÔ∏é</button>

    <!-- Traffic symbol: custom SVG circle with cross -->
    <button id="trafficBtn" title="Traffic">
        <svg class="symbol-box" viewBox="0 0 24 24">
            <circle cx="12" cy="12" r="5"/>
            <line x1="12" y1="7" x2="12" y2="17"/>
            <line x1="7" y1="12" x2="17" y2="12"/>
        </svg>
    </button>
</div>

<!-- Map -->
<div id="map"></div>

<!-- Glassy pop-up -->
<div id="formContainer">
    <form id="flightForm">
        <h2>Upload Flight Plan</h2>
        <label>Flight Plan JSON</label>
        <input type="file" id="flightFile" accept=".json" required>
        <button type="submit">Load Flight</button>
    </form>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
// ===== Map setup =====
const map = L.map('map',{minZoom:3,maxZoom:15,zoomControl:true}).setView([10,105],5);
L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png',{
    attribution:'&copy; OpenStreetMap, CARTO', subdomains:'abcd', maxZoom:19
}).addTo(map);

// ===== Flight plan =====
let flightLayer = null;
document.getElementById('flightForm').addEventListener('submit', async e=>{
    e.preventDefault();
    const file = document.getElementById('flightFile').files[0];
    if(!file) return alert("Select JSON");
    const content = await file.text();
    const plan = JSON.parse(content);
    if(!plan.route||plan.route.length<2) return alert("Need 2+ coordinates");
    if(flightLayer) map.removeLayer(flightLayer);
    flightLayer = L.polyline(plan.route,{color:'#2ca1ff',weight:4,opacity:0.9,dashArray:'8,6'}).addTo(map);
    flightLayer.bindPopup(`<b>Flight:</b>${plan.flightNumber||'N/A'}<br><b>Aircraft:</b>${plan.aircraft||'N/A'}<br><b>Airline:</b>${plan.airline||'N/A'}`);
    map.fitBounds(flightLayer.getBounds(), {padding:[50,50], maxZoom:10});
});

// ===== Sidebar buttons =====
const formContainer = document.getElementById('formContainer');
document.getElementById('newFlightBtn').addEventListener('click', ()=>{
    formContainer.classList.add('show');
    formContainer.style.display = 'block';
});
document.getElementById('homeBtn').addEventListener('click', ()=>{
    formContainer.style.display = 'none';
    formContainer.classList.remove('show');
});
document.getElementById('trafficBtn').addEventListener('click', ()=>{
    formContainer.style.display = 'none';
    formContainer.classList.remove('show');
});
</script>
</body>
</html>
